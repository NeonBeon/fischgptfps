local g = game
local w = g.Workspace
local l = g.Lighting
local t = w.Terrain
local players = g:GetService("Players")
local localPlayer = players.LocalPlayer

-- Function to remove all water by setting all terrain to Air
local function removeWater()
    t:Clear()  -- Clears all terrain, effectively removing any existing water
end

-- Terrain settings to make it invisible
t.WaterWaveSize = 0
t.WaterWaveSpeed = 0
t.WaterReflectance = 0
t.WaterTransparency = 1        -- Fully transparent water
t.Transparency = 1             -- Fully transparent terrain
t.CastShadow = false           -- No shadows for terrain

-- Lighting settings to reduce visuals
l.GlobalShadows = false
l.FogEnd = 0                   -- Extreme fog for complete darkness
l.Brightness = 0

-- Rendering quality setting for a potential FPS boost
settings().Rendering.QualityLevel = "Level01"

-- Function to hide all objects in the Workspace, except tools in the player's character
local function hideWorkspaceObjects()
    for _, v in pairs(w:GetDescendants()) do
        if v:IsA("BasePart") and v.Parent ~= localPlayer.Character then
            v.Transparency = 1  -- Make parts invisible
            v.CastShadow = false  -- Disable shadows
        elseif v:IsA("Decal") or v:IsA("Texture") then
            v.Transparency = 1  -- Hide all decals and textures
        elseif v:IsA("ParticleEmitter") or v:IsA("Trail") then
            v.Enabled = false  -- Turn off particles and trails
        elseif v:IsA("MeshPart") and v.Parent ~= localPlayer.Character then
            v.Transparency = 1
            v.CastShadow = false
        end
    end
end

-- Function to hide other players' avatars, but not the local player
local function hideOtherAvatars()
    for _, player in ipairs(players:GetPlayers()) do
        if player ~= localPlayer and player.Character then
            player.Character:Destroy()  -- Remove the character model of other players
        end
    end
end

-- Connect PlayerAdded to hide avatars when new players join
players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        hideOtherAvatars()
    end)
end)

-- Initial calls to hide everything, remove water, and hide other avatars
removeWater()
hideWorkspaceObjects()
hideOtherAvatars()

-- Hide newly added objects in the Workspace, excluding tools
w.DescendantAdded:Connect(function(obj)
    if obj:IsA("BasePart") and obj.Parent ~= localPlayer.Character then
        obj.Transparency = 1
        obj.CastShadow = false
    elseif obj:IsA("Decal") or obj:IsA("Texture") then
        obj.Transparency = 1
    elseif obj:IsA("ParticleEmitter") or obj:IsA("Trail") then
        obj.Enabled = false
    end
end)

-- Disable all post-processing effects for additional visual simplicity
for _, effect in pairs(l:GetChildren()) do
    if effect:IsA("BlurEffect") or effect:IsA("SunRaysEffect") or effect:IsA("ColorCorrectionEffect") 
    or effect:IsA("BloomEffect") or effect:IsA("DepthOfFieldEffect") then
        effect.Enabled = false
    end
end
